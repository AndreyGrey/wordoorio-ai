# üïê –ù–ê–°–¢–†–û–ô–ö–ê –ê–í–¢–û–û–ë–ù–û–í–õ–ï–ù–ò–Ø –¢–û–ö–ï–ù–û–í

## üìä –≠–ö–û–ù–û–ú–ò–Ø –†–ï–°–£–†–°–û–í

### ‚ùå –ë–´–õ–û (–Ω–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ):
```bash
*/8 * * * * python3 refresh_token.py
# = 180 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —Å—É—Ç–∫–∏
```

### ‚úÖ –°–¢–ê–õ–û (–æ–ø—Ç–∏–º–∞–ª—å–Ω–æ):
```bash
0 */3 * * * /usr/bin/python3 /path/to/refresh_token.py
# = 8 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —Å—É—Ç–∫–∏ (–≤ 22.5 —Ä–∞–∑–∞ –º–µ–Ω—å—à–µ!)
```

## üß† –£–ú–ù–ê–Ø –õ–û–ì–ò–ö–ê

–°–∫—Ä–∏–ø—Ç —Ç–µ–ø–µ—Ä—å:
1. **–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** —Ç–µ–∫—É—â–µ–≥–æ —Ç–æ–∫–µ–Ω–∞
2. **–û–±–Ω–æ–≤–ª—è–µ—Ç –¢–û–õ–¨–ö–û –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏**
3. **–≠–∫–æ–Ω–æ–º–∏—Ç —Ä–µ—Å—É—Ä—Å—ã** –ø—Ä–∏ –≤–∞–ª–∏–¥–Ω–æ–º —Ç–æ–∫–µ–Ω–µ

## ‚öôÔ∏è –ù–ê–°–¢–†–û–ô–ö–ê CRON

### –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞:
```bash
# –†–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º crontab
crontab -e

# –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç—Ä–æ–∫—É (–∫–∞–∂–¥—ã–µ 3 —á–∞—Å–∞)
0 */3 * * * /usr/bin/python3 /Users/andrewkondakow/Documents/Projects/Wordoorio/refresh_token.py

# –ü—Ä–æ–≤–µ—Ä—è–µ–º
crontab -l
```

### –ü—Ä–æ–¥–∞–∫—à–µ–Ω —Å–µ—Ä–≤–µ—Ä:
```bash
# –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è yc-user 
crontab -e

# –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç—Ä–æ–∫—É —Å sudo –ø—Ä–∞–≤–∞–º–∏ –¥–ª—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–∏—Å–∞
0 */3 * * * sudo /usr/bin/python3 /var/www/wordoorio/server_token_refresh.py >> /var/log/wordoorio-tokens.log 2>&1

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ sudo –ø—Ä–∞–≤ (–≤—ã–ø–æ–ª–Ω–∏—Ç—å –æ–¥–∏–Ω —Ä–∞–∑)
echo "yc-user ALL=(ALL) NOPASSWD: /bin/systemctl restart wordoorio, /bin/systemctl reload wordoorio" | sudo tee /etc/sudoers.d/wordoorio-service

# –°–æ–∑–¥–∞–Ω–∏–µ –ª–æ–≥ —Ñ–∞–π–ª–∞
sudo touch /var/log/wordoorio-tokens.log
sudo chown yc-user:yc-user /var/log/wordoorio-tokens.log
```

## üìà –†–ê–°–ü–ò–°–ê–ù–ò–ï –û–ë–ù–û–í–õ–ï–ù–ò–ô

| –í—Ä–µ–º—è | –î–µ–π—Å—Ç–≤–∏–µ |
|-------|----------|
| 00:00 | –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞ |
| 03:00 | –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞ |
| 06:00 | –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞ |
| 09:00 | –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞ |
| 12:00 | –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞ |
| 15:00 | –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞ |
| 18:00 | –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞ |
| 21:00 | –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞ |

## üõ°Ô∏è –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨

- **–°—Ä–æ–∫ –∂–∏–∑–Ω–∏ —Ç–æ–∫–µ–Ω–∞**: –¥–æ 12 —á–∞—Å–æ–≤
- **–ß–∞—Å—Ç–æ—Ç–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏**: –∫–∞–∂–¥—ã–µ 3 —á–∞—Å–∞
- **–ó–∞–ø–∞—Å –≤—Ä–µ–º–µ–Ω–∏**: 4x –∑–∞–ø–∞—Å –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏
- **–≠–∫–æ–Ω–æ–º–∏—è**: 95% –º–µ–Ω—å—à–µ API –≤—ã–∑–æ–≤–æ–≤

## üß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï

```bash
# –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
python3 refresh_token.py

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
ssh yc-user@158.160.126.200 "sudo python3 /var/www/wordoorio/server_token_refresh.py"

# –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
# üîÑ –ù–∞—á–∏–Ω–∞–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ - 2025-11-30 09:56:08
# ‚úÖ –ü–æ–ª—É—á–µ–Ω –Ω–æ–≤—ã–π —Ç–æ–∫–µ–Ω: t1.9euelZqdypfIlpmNi...
# ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω —Ç–æ–∫–µ–Ω –≤ /var/www/wordoorio/.env
# ‚úÖ –°–µ—Ä–≤–∏—Å wordoorio –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω
# ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ –∑–∞–≤–µ—Ä—à–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ
```

## üìù –õ–û–ì–ò

–õ–æ–≥–∏ –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–æ–≤:
```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
ssh yc-user@158.160.126.200 "sudo tail -20 /var/log/wordoorio-tokens.log"

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
ssh yc-user@158.160.126.200 "sudo tail -f /var/log/wordoorio-tokens.log"
```

## üìä –°–¢–ê–¢–£–° –°–ò–°–¢–ï–ú–´

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ cron –∑–∞–¥–∞—á–∏
ssh yc-user@158.160.126.200 "crontab -l"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –∑–∞–ø—É—Å–∫–æ–≤
ssh yc-user@158.160.126.200 "sudo journalctl -u cron | grep wordoorio | tail -5"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ —Ç–æ–∫–µ–Ω–∞
ssh yc-user@158.160.126.200 "cat /var/www/wordoorio/.env | grep YANDEX_IAM_TOKEN"
```

–†–∞–∑–º–µ—Ä –ª–æ–≥–æ–≤ –±—É–¥–µ—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º –±–ª–∞–≥–æ–¥–∞—Ä—è —É–º–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–µ.