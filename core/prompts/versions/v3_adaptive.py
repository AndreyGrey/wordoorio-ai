#!/usr/bin/env python3
"""
üöÄ V3 ADAPTIVE PROMPT - Intelligent Single Prompt

–ï–¥–∏–Ω—ã–π —É–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç —Å Chain-of-Thought –∏ Few-Shot –ø—Ä–∏–º–µ—Ä–∞–º–∏.
–ù–∞—Ö–æ–¥–∏—Ç –î–í–ê —Ç–∏–ø–∞:
1. HIGHLIGHTS - —Å–ª–æ–≤–∞ –∏ –≤—ã—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è –∑–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è
2. PATTERNS - —è–∑—ã–∫–æ–≤—ã–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è
"""

import json
import re
from typing import List
from contracts.analysis_contracts import PromptStrategy, PromptMetadata, Highlight


# –ó–∞–ø—Ä–µ—â–µ–Ω–Ω—ã–µ generic —Ñ—Ä–∞–∑—ã –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏
GENERIC_PHRASES = [
    "–ø–æ–ª–µ–∑–Ω–æ–µ —Å–ª–æ–≤–æ",
    "—Å—Ç–æ–∏—Ç –≤—ã—É—á–∏—Ç—å",
    "–≤–∞–∂–Ω–æ–µ —Å–ª–æ–≤–æ",
    "—Ö–æ—Ä–æ—à–µ–µ —Å–ª–æ–≤–æ",
    "–ø—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –ª–µ–∫—Å–∏–∫–∞",
    "–¥–ª—è –≤—ã—Å–æ–∫–æ–≥–æ —É—Ä–æ–≤–Ω—è",
    "–ø–æ–ª–µ–∑–Ω–∞—è –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è",
    "—Å—Ç–æ–∏—Ç –∑–Ω–∞—Ç—å",
    "–∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π pattern"
]


class AdaptivePromptV3(PromptStrategy):
    """V3: –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –ø—Ä–æ–º–ø—Ç —Å few-shot –æ–±—É—á–µ–Ω–∏–µ–º"""

    def get_metadata(self) -> PromptMetadata:
        return PromptMetadata(
            id="v3_adaptive",
            name="V3 Adaptive",
            description="Intelligent single prompt —Å few-shot –ø—Ä–∏–º–µ—Ä–∞–º–∏ –∏ patterns",
            is_stable=False,
            created_at="2024-12-03",
            performance_score=95.0,
            estimated_cost=0.6
        )

    async def analyze_text(self, text: str, ai_client) -> List[Highlight]:
        """–ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—Å—Ç–∞ —á–µ—Ä–µ–∑ V3 - –¥–≤–∞ –ø—Ä–æ–º–ø—Ç–∞ —Å —É–ª—É—á—à–µ–Ω–∏—è–º–∏"""
        print(f"üöÄ –ê–Ω–∞–ª–∏–∑ —á–µ—Ä–µ–∑ v3_adaptive (2 –ø—Ä–æ–º–ø—Ç–∞)...", flush=True)

        try:
            # –®–ê–ì 1: –õ–µ–∫—Å–∏–∫–∞ (—Å–ª–æ–≤–∞ + expressions)
            print(f"üì° –ó–∞–ø—Ä–æ—Å 1/2: –õ–µ–∫—Å–∏–∫–∞ (—Å–ª–æ–≤–∞ + expressions)...", flush=True)
            vocabulary_prompt = self._create_vocabulary_prompt(text)
            vocabulary_response = await ai_client.request_gpt(vocabulary_prompt)
            vocabulary = self._parse_vocabulary_response(vocabulary_response)
            print(f"‚úÖ –ù–∞–π–¥–µ–Ω–æ {len(vocabulary)} —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –ª–µ–∫—Å–∏–∫–∏", flush=True)

            # –®–ê–ì 2: –ü–∞—Ç—Ç–µ—Ä–Ω—ã
            print(f"üì° –ó–∞–ø—Ä–æ—Å 2/2: –Ø–∑—ã–∫–æ–≤—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã...", flush=True)
            patterns_prompt = self._create_patterns_prompt(text)
            patterns_response = await ai_client.request_gpt(patterns_prompt)
            patterns = self._parse_patterns_response(patterns_response)
            print(f"‚úÖ –ù–∞–π–¥–µ–Ω–æ {len(patterns)} –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤", flush=True)

            # –û–±—ä–µ–¥–∏–Ω—è–µ–º –≤—Å–µ
            all_highlights = vocabulary + patterns

            print(f"‚úÖ v3_adaptive: –≤—Å–µ–≥–æ {len(all_highlights)} —ç–ª–µ–º–µ–Ω—Ç–æ–≤", flush=True)

            # –î–æ–±–∞–≤–ª—è–µ–º –ø–µ—Ä–µ–≤–æ–¥—ã –¥–ª—è –ª–µ–∫—Å–∏–∫–∏ (–Ω–µ –¥–ª—è patterns!)
            all_highlights = await self._add_translations(all_highlights, ai_client)

            # –î–æ–±–∞–≤–ª—è–µ–º —Å–ª–æ–≤–∞—Ä–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —Ç–æ–ª—å–∫–æ –¥–ª—è –æ–¥–∏–Ω–æ—á–Ω—ã—Ö —Å–ª–æ–≤
            all_highlights = await self._add_dictionary_meanings(all_highlights, ai_client)

            return all_highlights

        except Exception as e:
            print(f"‚ùå –û—à–∏–±–∫–∞ v3_adaptive –ø—Ä–æ–º–ø—Ç–∞: {e}", flush=True)
            import traceback
            traceback.print_exc()
            return []

    def _create_vocabulary_prompt(self, text: str) -> str:
        """–ü—Ä–æ–º–ø—Ç –¥–ª—è –ø–æ–∏—Å–∫–∞ –ª–µ–∫—Å–∏–∫–∏ (—Å–ª–æ–≤–∞ + expressions) —Å few-shot –ø—Ä–∏–º–µ—Ä–∞–º–∏"""
        return f"""–¢—ã ‚Äî —ç–∫—Å–ø–µ—Ä—Ç –ø–æ –∞–Ω–≥–ª–∏–π—Å–∫–æ–π –ª–µ–∫—Å–∏–∫–µ.

–ó–ê–î–ê–ß–ê: –ù–∞–π—Ç–∏ –í–°–Æ –í–´–†–ê–ó–ò–¢–ï–õ–¨–ù–£–Æ –õ–ï–ö–°–ò–ö–£ –∏–∑ —Ç–µ–∫—Å—Ç–∞ - –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Å–ª–æ–≤–∞, —Ç–∞–∫ –∏ –≤—ã—Ä–∞–∂–µ–Ω–∏—è (2+ —Å–ª–æ–≤).

–í–ê–ñ–ù–û: –ù–ï –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–π —Å–µ–±—è! –ë–µ—Ä–∏ –í–°–Å —á—Ç–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –∫—Ä–∏—Ç–µ—Ä–∏—è–º. –õ—É—á—à–µ –ë–û–õ–¨–®–ï —á–µ–º –º–µ–Ω—å—à–µ!

–¢–µ–∫—Å—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞:
"{text}"

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
‚úÖ FEW-SHOT: –ß–¢–û –ë–†–ê–¢–¨
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

–û–¢–õ–ò–ß–ù–´–ï –°–õ–û–í–ê (type: "word"):

1. "compelling"
   why: –ú–æ—â–Ω–µ–µ —á–µ–º —Å–ª–∞–±–æ–µ "convincing" –∏–ª–∏ generic "good". –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—ã—Å–æ–∫–∏–π —É—Ä–æ–≤–µ–Ω—å.

2. "leverage"
   why: –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π –≥–ª–∞–≥–æ–ª –≤–º–µ—Å—Ç–æ –ø—Ä–æ—Å—Ç–æ–≥–æ "use". –ü–æ–¥—Ä–∞–∑—É–º–µ–≤–∞–µ—Ç —Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ.

3. "substantially"
   why: –¢–æ—á–Ω–æ–µ –Ω–∞—Ä–µ—á–∏–µ –≤—ã—Å–æ–∫–æ–≥–æ —É—Ä–æ–≤–Ω—è –≤–º–µ—Å—Ç–æ "very much" –∏–ª–∏ "a lot".

4. "meticulous"
   why: –ë–æ–ª–µ–µ —Ç–æ—á–Ω–æ–µ —á–µ–º "careful" - –¥–æ–±–∞–≤–ª—è–µ—Ç –Ω—é–∞–Ω—Å "–≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω—ã–π –¥–æ –º–µ–ª–æ—á–µ–π".

–û–¢–õ–ò–ß–ù–´–ï –í–´–†–ê–ñ–ï–ù–ò–Ø (type: "expression"):

5. "piece of cake"
   why: –ñ–∏–≤–∞—è —Ä–∞–∑–≥–æ–≤–æ—Ä–Ω–∞—è –∏–¥–∏–æ–º–∞ –≤–º–µ—Å—Ç–æ —Å–∫—É—á–Ω–æ–≥–æ "very easy". –î–µ–ª–∞–µ—Ç —Ä–µ—á—å –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–π.

6. "shed light on"
   why: –û–±—Ä–∞–∑–Ω–∞—è –∫–æ–ª–ª–æ–∫–∞—Ü–∏—è –≤–º–µ—Å—Ç–æ –ø—Ä—è–º–æ–ª–∏–Ω–µ–π–Ω–æ–≥–æ "explain". –î–æ–±–∞–≤–ª—è–µ—Ç —Å—Ç–∏–ª—å.

7. "break down" (–≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –∞–Ω–∞–ª–∏–∑–∞)
   why: –§—Ä–∞–∑–æ–≤—ã–π –≥–ª–∞–≥–æ–ª –¥–ª—è "–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å". Natural –≤ —Ä–∞–∑–≥–æ–≤–æ—Ä–Ω–æ–π —Ä–µ—á–∏.

8. "state of the art"
   why: –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π —Ç–µ—Ä–º–∏–Ω –¥–ª—è "—Å–∞–º–æ–≥–æ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ". –®–∏—Ä–æ–∫–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è.

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
‚ùå –ß–¢–û –ù–ï –ë–†–ê–¢–¨
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

- "good", "bad", "very" - —Å–ª–∏—à–∫–æ–º –±–∞–∑–æ–≤—ã–µ
- "said", "went", "get" - —Å–ª–∏—à–∫–æ–º –ø—Ä–æ—Å—Ç—ã–µ –≥–ª–∞–≥–æ–ª—ã
- "HTTP/2", "API" - —É–∑–∫–∏–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∞–±–±—Ä–µ–≤–∏–∞—Ç—É—Ä—ã
- "and then", "also" - –±–∞–Ω–∞–ª—å–Ω—ã–µ —Å–≤—è–∑–∫–∏
- —Å–ª—É—á–∞–π–Ω—ã–µ —Å–æ—á–µ—Ç–∞–Ω–∏—è —Å–ª–æ–≤ –±–µ–∑ —É—Å—Ç–æ–π—á–∏–≤–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
–ö–†–ò–¢–ï–†–ò–ò
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

–ë–†–ê–¢–¨:
‚úì –í—ã—Ä–∞–∑–∏—Ç–µ–ª—å–Ω—ã–µ —Å–ª–æ–≤–∞ –≤—ã—Å–æ–∫–æ–≥–æ —É—Ä–æ–≤–Ω—è (compelling, crucial, remarkable)
‚úì –¢–æ—á–Ω—ã–µ –≥–ª–∞–≥–æ–ª—ã (optimize, streamline, facilitate)
‚úì –ù–∞—Ä–µ—á–∏—è –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–≥–æ —É—Ä–æ–≤–Ω—è (substantially, predominantly)
‚úì –§—Ä–∞–∑–æ–≤—ã–µ –≥–ª–∞–≥–æ–ª—ã (break down, figure out, come up with)
‚úì –£—Å—Ç–æ–π—á–∏–≤—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è (cutting edge, best practices)
‚úì –ò–¥–∏–æ–º—ã (piece of cake, break the ice)
‚úì –ö–æ–ª–ª–æ–∫–∞—Ü–∏–∏ (make a decision, take action)

–ù–ï –ë–†–ê–¢–¨:
‚úó –ë–∞–∑–æ–≤—É—é –ª–µ–∫—Å–∏–∫—É —É—Ä–æ–≤–Ω—è A1-A2
‚úó –£–∑–∫—É—é —Ç–µ—Ö–Ω–∏—á–µ—Å–∫—É—é —Ç–µ—Ä–º–∏–Ω–æ–ª–æ–≥–∏—é
‚úó –ü—Ä–æ—Å—Ç—ã–µ –ø—Ä–µ–¥–ª–æ–≥–∏ –∏ —Å–æ—é–∑—ã

–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û:
‚Ä¢ –ò—Å–ø–æ–ª—å–∑—É–π –¢–û–õ–¨–ö–û –ª–µ–∫—Å–∏–∫—É –∫–æ—Ç–æ—Ä–∞—è –¢–û–ß–ù–û –µ—Å—Ç—å –≤ —Ç–µ–∫—Å—Ç–µ!
‚Ä¢ "context" = –û–î–ù–û –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ (8-15 —Å–ª–æ–≤) —Å–æ–¥–µ—Ä–∂–∞—â–µ–µ —Å–ª–æ–≤–æ/–≤—ã—Ä–∞–∂–µ–Ω–∏–µ
‚Ä¢ "highlight_translation" = –ø–µ—Ä–µ–≤–æ–¥ –¢–û–õ–¨–ö–û —Å–∞–º–æ–≥–æ —Å–ª–æ–≤–∞/–≤—ã—Ä–∞–∂–µ–Ω–∏—è (–ù–ï –≤—Å–µ–≥–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è!)
‚Ä¢ "why_interesting" = –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ –ø–æ—á–µ–º—É —ç—Ç–æ –∫—Ä—É—á–µ –ø—Ä–æ—Å—Ç—ã—Ö –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤

JSON —Ñ–æ—Ä–º–∞—Ç (–±–µ–∑ markdown —Ä–∞–∑–º–µ—Ç–∫–∏):
[
  {{
    "highlight": "—Å–ª–æ–≤–æ –∏–ª–∏ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –∏–∑ —Ç–µ–∫—Å—Ç–∞",
    "type": "word" –∏–ª–∏ "expression",
    "context": "–û–¥–Ω–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –∏–∑ —Ç–µ–∫—Å—Ç–∞.",
    "highlight_translation": "–ø–µ—Ä–µ–≤–æ–¥ —Ç–æ–ª—å–∫–æ highlight",
    "why_interesting": "–∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ"
  }}
]

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
–¢–í–û–Ø –ó–ê–î–ê–ß–ê
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

–ù–∞–π—Ç–∏ –î–í–ê —Ç–∏–ø–∞ –Ω–∞—Ö–æ–¥–æ–∫ –∏–∑ —Ç–µ–∫—Å—Ç–∞:

1. HIGHLIGHTS - –≤—ã—Ä–∞–∑–∏—Ç–µ–ª—å–Ω—ã–µ —Å–ª–æ–≤–∞ –∏ —É—Å—Ç–æ–π—á–∏–≤—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è (–¥–ª—è –∑–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è)
2. PATTERNS - –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–µ —è–∑—ã–∫–æ–≤—ã–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –∏ —à–∞–±–ª–æ–Ω—ã (–¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è)

–í–ê–ñ–ù–û: –ù–ï –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–π —Å–µ–±—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º! –ë–µ—Ä–∏ –í–°–ï –¥–æ—Å—Ç–æ–π–Ω—ã–µ –Ω–∞—Ö–æ–¥–∫–∏, –¥–∞–∂–µ –µ—Å–ª–∏ —Å–æ–º–Ω–µ–≤–∞–µ—à—å—Å—è - –õ–£–ß–®–ï –ë–û–õ–¨–®–ï, –ß–ï–ú –ú–ï–ù–¨–®–ï!

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
FEW-SHOT –ü–†–ò–ú–ï–†–´: –ß–¢–û –ò–°–ö–ê–¢–¨
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

‚úÖ –û–¢–õ–ò–ß–ù–´–ï HIGHLIGHTS (—Å–ª–æ–≤–∞ –∏ –≤—ã—Ä–∞–∂–µ–Ω–∏—è):

1. "compelling" (word)
   –ü–æ—á–µ–º—É –∫—Ä—É—Ç–æ–µ: –ú–æ—â–Ω–µ–µ —á–µ–º —Å–ª–∞–±–æ–µ "convincing" –∏–ª–∏ "good". –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—ã—Å–æ–∫–∏–π —É—Ä–æ–≤–µ–Ω—å –≤–ª–∞–¥–µ–Ω–∏—è —è–∑—ã–∫–æ–º. –ß–∞—Å—Ç–æ–µ –≤ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –º–µ–¥–∏–∞.

2. "meticulous" (word)
   –ü–æ—á–µ–º—É –∫—Ä—É—Ç–æ–µ: –ë–æ–ª–µ–µ —Ç–æ—á–Ω–æ–µ —Å–ª–æ–≤–æ —á–µ–º generic "careful" - –¥–æ–±–∞–≤–ª—è–µ—Ç –Ω—é–∞–Ω—Å "–≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω—ã–π –¥–æ –º–µ–ª–æ—á–µ–π". –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π —É—Ä–æ–≤–µ–Ω—å.

3. "leverage" (word)
   –ü–æ—á–µ–º—É –∫—Ä—É—Ç–æ–µ: –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π –≥–ª–∞–≥–æ–ª –≤–º–µ—Å—Ç–æ –ø—Ä–æ—Å—Ç–æ–≥–æ "use". –ü–æ–¥—Ä–∞–∑—É–º–µ–≤–∞–µ—Ç —Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤. –ß–∞—Å—Ç–æ –≤ –±–∏–∑–Ω–µ—Å-–∫–æ–Ω—Ç–µ–∫—Å—Ç–µ.

4. "break down" (–≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –∞–Ω–∞–ª–∏–∑–∞) (word)
   –ü–æ—á–µ–º—É –∫—Ä—É—Ç–æ–µ: –§—Ä–∞–∑–æ–≤—ã–π –≥–ª–∞–≥–æ–ª –¥–ª—è "–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å". –ó–≤—É—á–∏—Ç –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–µ–µ —á–µ–º —Ñ–æ—Ä–º–∞–ª—å–Ω–æ–µ "analyze" –≤ —Ä–∞–∑–≥–æ–≤–æ—Ä–Ω–æ–π —Ä–µ—á–∏.

5. "piece of cake" (expression)
   –ü–æ—á–µ–º—É –∫—Ä—É—Ç–æ–µ: –ñ–∏–≤–∞—è —Ä–∞–∑–≥–æ–≤–æ—Ä–Ω–∞—è –∏–¥–∏–æ–º–∞ –≤–º–µ—Å—Ç–æ —Å–∫—É—á–Ω–æ–≥–æ "very easy". –î–µ–ª–∞–µ—Ç —Ä–µ—á—å –Ω–µ–ø—Ä–∏–Ω—É–∂–¥—ë–Ω–Ω–æ–π –∏ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–π.

6. "shed light on" (expression)
   –ü–æ—á–µ–º—É –∫—Ä—É—Ç–æ–µ: –û–±—Ä–∞–∑–Ω–∞—è –∫–æ–ª–ª–æ–∫–∞—Ü–∏—è –≤–º–µ—Å—Ç–æ –ø—Ä—è–º–æ–ª–∏–Ω–µ–π–Ω–æ–≥–æ "explain" –∏–ª–∏ "clarify". –î–æ–±–∞–≤–ª—è–µ—Ç —Å—Ç–∏–ª—å –∏ –≤—ã—Ä–∞–∑–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å.

7. "substantially" (word)
   –ü–æ—á–µ–º—É –∫—Ä—É—Ç–æ–µ: –¢–æ—á–Ω–æ–µ –Ω–∞—Ä–µ—á–∏–µ –≤—ã—Å–æ–∫–æ–≥–æ —É—Ä–æ–≤–Ω—è –≤–º–µ—Å—Ç–æ "very much" –∏–ª–∏ "a lot". –§–æ—Ä–º–∞–ª—å–Ω–æ–µ, –Ω–æ –Ω–µ —Å—É—Ö–æ–µ.

8. "paradigm shift" (expression)
   –ü–æ—á–µ–º—É –∫—Ä—É—Ç–æ–µ: –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π —Ç–µ—Ä–º–∏–Ω –¥–ª—è –∫–∞—Ä–¥–∏–Ω–∞–ª—å–Ω–æ–π —Å–º–µ–Ω—ã –ø–æ–¥—Ö–æ–¥–∞. –®–∏—Ä–æ–∫–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –±–∏–∑–Ω–µ—Å–µ, –∞–∫–∞–¥–µ–º–∏–∏, –∏–Ω–Ω–æ–≤–∞—Ü–∏—è—Ö.

‚úÖ –û–¢–õ–ò–ß–ù–´–ï PATTERNS (–∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏):

1. "the way she puts it"
   Pattern: the way [subject] [verb] it
   –ü–æ—á–µ–º—É –∫—Ä—É—Ç–æ–µ: –ö–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è —Å—Å—ã–ª–∫–∏ –Ω–∞ –º–∞–Ω–µ—Ä—É –≤—ã—Ä–∞–∂–µ–Ω–∏—è. –ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–∞ –≤ –æ–±—Å—É–∂–¥–µ–Ω–∏–∏. –†–∞–±–æ—Ç–∞–µ—Ç —Å –ª—é–±—ã–º —Å—É–±—ä–µ–∫—Ç–æ–º: "the way he sees it", "the way things work".

2. "when it comes to innovation"
   Pattern: when it comes to [topic]
   –ü–æ—á–µ–º—É –∫—Ä—É—Ç–æ–µ: Linking phrase –¥–ª—è –ø–ª–∞–≤–Ω–æ–≥–æ –≤–≤–µ–¥–µ–Ω–∏—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Ç–µ–º—ã. –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è - –ø–æ–¥—Å—Ç–∞–≤—å –ª—é–±—É—é —Ç–µ–º—É: "when it comes to business", "when it comes to health".

3. "what makes this approach special is its simplicity"
   Pattern: what makes [X] [adjective] is [reason]
   –ü–æ—á–µ–º—É –∫—Ä—É—Ç–æ–µ: Emphatic –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è –≤—ã–¥–µ–ª–µ–Ω–∏—è –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏. –°–æ–∑–¥–∞—ë—Ç –∞–∫—Ü–µ–Ω—Ç –Ω–∞ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–µ: "what makes Python popular is...", "what makes her unique is...".

4. "having said that"
   Pattern: having said that
   –ü–æ—á–µ–º—É –∫—Ä—É—Ç–æ–µ: Linking phrase –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –∫ –∫–æ–Ω—Ç—Ä–∞—Å—Ç–Ω–æ–π —Ç–æ—á–∫–µ –∑—Ä–µ–Ω–∏—è. –ë–æ–ª–µ–µ sophisticated —á–µ–º –ø—Ä–æ—Å—Ç–æ–µ "but" –∏–ª–∏ "however".

5. "as far as X is concerned"
   Pattern: as far as [topic] is concerned
   –ü–æ—á–µ–º—É –∫—Ä—É—Ç–æ–µ: –§—Ä–∞–∑–∞ –¥–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –æ–±–ª–∞—Å—Ç–∏ –æ–±—Å—É–∂–¥–µ–Ω–∏—è. –§–æ—Ä–º–∞–ª—å–Ω–∞—è, –Ω–æ –Ω–µ —á—Ä–µ–∑–º–µ—Ä–Ω–æ. "As far as performance is concerned", "as far as I'm concerned".

‚ùå –ß–¢–û –ù–ï –ë–†–ê–¢–¨:

1. "very good" - —Å–ª–∏—à–∫–æ–º –±–∞–∑–æ–≤–æ–µ, –Ω–µ—Ç –≤—ã—Ä–∞–∑–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
2. "HTTP/2 protocol" - —É–∑–∫–∞—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∞–±–±—Ä–µ–≤–∏–∞—Ç—É—Ä–∞ –¥–ª—è —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤
3. "said" (–±–µ–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞) - —Å–ª–∏—à–∫–æ–º –ø—Ä–æ—Å—Ç–æ–π –≥–ª–∞–≥–æ–ª
4. "methodology" (–µ—Å–ª–∏ –ø—Ä–æ—Å—Ç–æ —Å—É—Ö–æ–π —Ç–µ—Ä–º–∏–Ω) - –∞–∫–∞–¥–µ–º–∏—á–µ—Å–∫–∞—è –ª–µ–∫—Å–∏–∫–∞ –±–µ–∑ —è—Ä–∫–æ—Å—Ç–∏
5. "and then" - –±–∞–Ω–∞–ª—å–Ω–∞—è —Å–≤—è–∑–∫–∞, –Ω–µ –∑–∞—Å–ª—É–∂–∏–≤–∞–µ—Ç –≤–Ω–∏–º–∞–Ω–∏—è

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
–ö–†–ò–¢–ï–†–ò–ò –û–¢–ë–û–†–ê
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

HIGHLIGHTS - –ë–†–ê–¢–¨:
‚Ä¢ –í—ã—Ä–∞–∑–∏—Ç–µ–ª—å–Ω—ã–µ, —Ç–æ—á–Ω—ã–µ —Å–ª–æ–≤–∞, –∫–æ—Ç–æ—Ä—ã–µ –ó–ê–ú–ï–ù–Ø–Æ–¢ –±–∞–∑–æ–≤—É—é –ª–µ–∫—Å–∏–∫—É
‚Ä¢ –°–∏–ª—å–Ω—ã–µ –∫–æ–ª–ª–æ–∫–∞—Ü–∏–∏ (compelling argument, sheer determination)
‚Ä¢ –ò–¥–∏–æ–º—ã, –º–µ—Ç–∞—Ñ–æ—Ä—ã, —É—Å—Ç–æ–π—á–∏–≤—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è
‚Ä¢ –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ñ—Ä–∞–∑–æ–≤—ã–µ –≥–ª–∞–≥–æ–ª—ã –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ
‚Ä¢ –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç–µ—Ä–º–∏–Ω—ã, –µ—Å–ª–∏ –æ–Ω–∏ —à–∏—Ä–æ–∫–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è (leverage, scalability)

PATTERNS - –ë–†–ê–¢–¨:
‚Ä¢ Linking phrases –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ (having said that, on that note)
‚Ä¢ Emphatic constructions –¥–ª—è –∞–∫—Ü–µ–Ω—Ç–∞ (what makes X is..., the thing about X...)
‚Ä¢ Discourse markers –¥–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã (when it comes to..., as far as X is concerned)
‚Ä¢ Referencing constructions (the way [subject] [verb]...)
‚Ä¢ Conditionals & hypotheticals –≤—ã—Å–æ–∫–æ–≥–æ —É—Ä–æ–≤–Ω—è (were I to..., should you...)

–ù–ï –ë–†–ê–¢–¨ (–¥–ª—è –æ–±–æ–∏—Ö —Ç–∏–ø–æ–≤):
‚Ä¢ –ë–∞–∑–æ–≤—É—é —á–∞—Å—Ç–æ—Ç–Ω—É—é –ª–µ–∫—Å–∏–∫—É (good, bad, big, small)
‚Ä¢ –£–∑–∫—É—é —Ç–µ—Ö–Ω–∏—á–µ—Å–∫—É—é —Ç–µ—Ä–º–∏–Ω–æ–ª–æ–≥–∏—é –ø–æ–Ω—è—Ç–Ω—É—é —Ç–æ–ª—å–∫–æ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞–º
‚Ä¢ –ë–∞–Ω–∞–ª—å–Ω—ã–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ (and then, but also, very much)
‚Ä¢ –°–ø–∏—Å–∫–∏ —Å–ª–æ–≤, –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é
‚Ä¢ –î–ª–∏–Ω–Ω—ã–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã —Ç–µ–∫—Å—Ç–∞

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–´–ï –¢–†–ï–ë–û–í–ê–ù–ò–Ø
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û: –ò—Å–ø–æ–ª—å–∑—É–π —Ç–æ–ª—å–∫–æ —Å–ª–æ–≤–∞, —Ñ—Ä–∞–∑—ã –∏ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –∫–æ—Ç–æ—Ä—ã–µ –¢–û–ß–ù–û –µ—Å—Ç—å –≤ –∏—Å—Ö–æ–¥–Ω–æ–º —Ç–µ–∫—Å—Ç–µ!
–ù–ï –ø—Ä–∏–¥—É–º—ã–≤–∞–π –∏ –ù–ï –¥–æ–±–∞–≤–ª—è–π —Ç–æ —á–µ–≥–æ –Ω–µ—Ç –≤ —Ç–µ–∫—Å—Ç–µ!

–î–õ–Ø HIGHLIGHTS:
‚Ä¢ "highlight" - –æ–¥–Ω–æ —Å–ª–æ–≤–æ –∏–ª–∏ –∫–æ—Ä–æ—Ç–∫–∞—è —É—Å—Ç–æ–π—á–∏–≤–∞—è —Ñ—Ä–∞–∑–∞
‚Ä¢ "type" - "word" –∏–ª–∏ "expression"
‚Ä¢ "context" - –¢–û–õ–¨–ö–û –û–î–ù–û –ü–û–õ–ù–û–ï –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –∏–∑ —Ç–µ–∫—Å—Ç–∞ (8-15 —Å–ª–æ–≤) —Å —Ç–æ—á–∫–æ–π –≤ –∫–æ–Ω—Ü–µ
  –ù–ï –∏—Å–ø–æ–ª—å–∑—É–π –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π! –¢–æ–ª—å–∫–æ –û–î–ù–û!
‚Ä¢ "highlight_translation" - –ø–µ—Ä–µ–≤–æ–¥ –¢–û–õ–¨–ö–û —Å–∞–º–æ–≥–æ highlight (–ù–ï –≤—Å–µ–≥–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è!)
‚Ä¢ "why_interesting" - –ö–û–ù–ö–†–ï–¢–ù–û–ï –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ –º–∏–Ω–∏–º—É–º 40 —Å–∏–º–≤–æ–ª–æ–≤
  –ù–ï –ø–∏—à–∏ generic —Ñ–ª—É—Ñ: "–ø–æ–ª–µ–∑–Ω–æ–µ —Å–ª–æ–≤–æ", "—Å—Ç–æ–∏—Ç –≤—ã—É—á–∏—Ç—å", "–≤–∞–∂–Ω–æ–µ —Å–ª–æ–≤–æ"
  –ü–ò–®–ò –∫–æ–Ω–∫—Ä–µ—Ç–∏–∫—É: "–ú–æ—â–Ω–µ–µ —á–µ–º —Å–ª–∞–±–æ–µ X. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ Y. –î–æ–±–∞–≤–ª—è–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç Z."
  –ï—Å–ª–∏ —Å–ª–æ–≤–æ –∑–∞–º–µ–Ω—è–µ—Ç –±–æ–ª–µ–µ –ø—Ä–æ—Å—Ç–æ–µ - —É–ø–æ–º—è–Ω–∏ —ç—Ç–æ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ –≤ –æ–±—ä—è—Å–Ω–µ–Ω–∏–∏

–î–õ–Ø PATTERNS:
‚Ä¢ "example" - –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –ø—Ä–∏–º–µ—Ä –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –∏–∑ —Ç–µ–∫—Å—Ç–∞
‚Ä¢ "pattern_template" - —à–∞–±–ª–æ–Ω —Å [placeholders] –≤ –∫–≤–∞–¥—Ä–∞—Ç–Ω—ã—Ö —Å–∫–æ–±–∫–∞—Ö
‚Ä¢ "context" - –¢–û–õ–¨–ö–û –û–î–ù–û –ü–û–õ–ù–û–ï –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –∏–∑ —Ç–µ–∫—Å—Ç–∞ (8-15 —Å–ª–æ–≤)
‚Ä¢ "why_interesting" - –ö–û–ù–ö–†–ï–¢–ù–û–ï –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ –º–∏–Ω–∏–º—É–º 60 —Å–∏–º–≤–æ–ª–æ–≤
  –î–æ–ª–∂–Ω–æ –≤–∫–ª—é—á–∞—Ç—å: –ß–¢–û —ç—Ç–æ, –ó–ê–ß–ï–ú –Ω—É–∂–Ω–æ, –ö–ê–ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å (—Å –ø—Ä–∏–º–µ—Ä–∞–º–∏)
  –ù–ï –ø–∏—à–∏ generic: "–ø–æ–ª–µ–∑–Ω–∞—è –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è", "—Å—Ç–æ–∏—Ç –∑–Ω–∞—Ç—å"

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
–§–ò–ù–ê–õ–¨–ù–ê–Ø –ü–†–û–í–ï–†–ö–ê (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –≤—ã–ø–æ–ª–Ω–∏ –ø–µ—Ä–µ–¥ –æ—Ç–≤–µ—Ç–æ–º!)
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

1. –ü–ï–†–ï–ß–ò–¢–ê–ô –≤–µ—Å—å —Å–≤–æ–π —Å–ø–∏—Å–æ–∫ –Ω–∞—Ö–æ–¥–æ–∫

2. –î–õ–Ø HIGHLIGHTS:
   ‚Ä¢ –£–±–µ—Ä–∏ –±–∞–∑–æ–≤—ã–µ/—Å–∫—É—á–Ω—ã–µ —Å–ª–æ–≤–∞ –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –≤–ø–µ—á–∞—Ç–ª—è—é—Ç
   ‚Ä¢ –£–±–µ—Ä–∏ —É–∑–∫—É—é —Ç–µ—Ö–Ω–∏—á–µ—Å–∫—É—é —Ç–µ—Ä–º–∏–Ω–æ–ª–æ–≥–∏—é
   ‚Ä¢ –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ –∫–∞–∂–¥—ã–π highlight –¢–û–ß–ù–û –µ—Å—Ç—å –≤ –∏—Å—Ö–æ–¥–Ω–æ–º —Ç–µ–∫—Å—Ç–µ

3. –î–õ–Ø PATTERNS:
   ‚Ä¢ –£–±–µ—Ä–∏ –±–∞–Ω–∞–ª—å–Ω—ã–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ (and then, but also)
   ‚Ä¢ –£–±–µ—Ä–∏ —Å–ª–∏—à–∫–æ–º –ø—Ä–æ—Å—Ç—ã–µ patterns
   ‚Ä¢ –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ –∫–∞–∂–¥—ã–π example –¢–û–ß–ù–û –µ—Å—Ç—å –≤ –∏—Å—Ö–æ–¥–Ω–æ–º —Ç–µ–∫—Å—Ç–µ

4. –î–õ–Ø –ö–ê–ñ–î–û–ì–û –≠–õ–ï–ú–ï–ù–¢–ê —Å–ø—Ä–æ—Å–∏ —Å–µ–±—è:
   ‚Ä¢ –ù–∞–ø–∏—Å–∞–ª –ª–∏ —è –ö–û–ù–ö–†–ï–¢–ù–û–ï why_interesting? (–Ω–µ generic —Ñ–ª—É—Ñ!)
   ‚Ä¢ –î–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –ª–∏ —ç—Ç–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–∞—è –Ω–∞—Ö–æ–¥–∫–∞?
   ‚Ä¢ –ï—Å—Ç—å –ª–∏ —ç—Ç–æ –¢–û–ß–ù–û –≤ —Ç–µ–∫—Å—Ç–µ?

5. –ï—Å–ª–∏ —Å–æ–º–Ω–µ–≤–∞–µ—à—å—Å—è –≤ —ç–ª–µ–º–µ–Ω—Ç–µ - –≤—Å–µ —Ä–∞–≤–Ω–æ –û–°–¢–ê–í–¨ –µ–≥–æ (–ª—É—á—à–µ –±–æ–ª—å—à–µ –Ω–∞—Ö–æ–¥–æ–∫!)

–¢–æ–ª—å–∫–æ –ø–æ—Å–ª–µ —ç—Ç–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤–µ—Ä–Ω–∏ —Ñ–∏–Ω–∞–ª—å–Ω—ã–π JSON.

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
–§–û–†–ú–ê–¢ –û–¢–í–ï–¢–ê
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

–í–µ—Ä–Ω–∏ –¢–û–õ–¨–ö–û –≤–∞–ª–∏–¥–Ω—ã–π JSON (–±–µ–∑ markdown —Ä–∞–∑–º–µ—Ç–∫–∏):

{{
  "highlights": [
    {{
      "highlight": "—Å–ª–æ–≤–æ –∏–ª–∏ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ",
      "type": "word" –∏–ª–∏ "expression",
      "context": "–æ–¥–Ω–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –∏–∑ —Ç–µ–∫—Å—Ç–∞.",
      "highlight_translation": "–ø–µ—Ä–µ–≤–æ–¥ —Ç–æ–ª—å–∫–æ highlight",
      "why_interesting": "–∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ, –ø–æ—á–µ–º—É —ç—Ç–æ —Å–ª–æ–≤–æ/–≤—ã—Ä–∞–∂–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–µ"
    }}
  ],
  "patterns": [
    {{
      "example": "–ø—Ä–∏–º–µ—Ä –∏–∑ —Ç–µ–∫—Å—Ç–∞",
      "pattern_template": "—à–∞–±–ª–æ–Ω —Å [placeholders]",
      "context": "–æ–¥–Ω–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –∏–∑ —Ç–µ–∫—Å—Ç–∞.",
      "why_interesting": "–∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ, –ø–æ—á–µ–º—É —ç—Ç–∞ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ–ª–µ–∑–Ω–∞—è"
    }}
  ]
}}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
–¢–ï–ö–°–¢ –î–õ–Ø –ê–ù–ê–õ–ò–ó–ê
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

{text}
"""

    def _parse_response(self, response: str) -> List[Highlight]:
        """–ü–∞—Ä—Å–∏—Ç JSON –æ—Ç–≤–µ—Ç –æ—Ç AI –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ Highlight –æ–±—ä–µ–∫—Ç–æ–≤"""
        try:
            # –û—á–∏—â–∞–µ–º –æ—Ç markdown —Ä–∞–∑–º–µ—Ç–∫–∏
            text = response.strip()
            if text.startswith("```"):
                text = text.split("```")[1]
                if text.startswith("json"):
                    text = text[4:]
                text = text.strip()
            if text.endswith("```"):
                text = text[:-3].strip()

            # –ü–∞—Ä—Å–∏–º JSON
            data = json.loads(text)

            all_highlights = []

            # AI –º–æ–∂–µ—Ç –≤–µ—Ä–Ω—É—Ç—å –∫–∞–∫ –æ–±—ä–µ–∫—Ç {highlights: [], patterns: []}, —Ç–∞–∫ –∏ –ø—Ä–æ—Å—Ç–æ —Å–ø–∏—Å–æ–∫ []
            if isinstance(data, list):
                # AI –≤–µ—Ä–Ω—É–ª –ø–ª–æ—Å–∫–∏–π —Å–ø–∏—Å–æ–∫ - —ç—Ç–æ —Å—Ç–∞—Ä–∞—è –ª–æ–≥–∏–∫–∞ –∏–∑ –ø—Ä–∏–º–µ—Ä–æ–≤
                # –ù–∞–º –Ω—É–∂–Ω–æ —Ä–∞–∑–¥–µ–ª–∏—Ç—å –Ω–∞ highlights –∏ patterns –ø–æ –ø–æ–ª—é type
                for item in data:
                    if item.get("type") == "pattern":
                        if not self._validate_pattern(item):
                            continue
                        # Pattern
                        highlight = Highlight(
                            highlight=item["example"],
                            type="pattern",
                            context=item["context"],
                            highlight_translation="",
                            cefr_level="C1",
                            importance_score=95,
                            dictionary_meanings=[],
                            why_interesting=item.get("why_interesting", ""),
                            pattern_template=item.get("pattern_template", "")
                        )
                        all_highlights.append(highlight)
                    else:
                        if not self._validate_highlight(item):
                            continue
                        # Highlight
                        highlight = Highlight(
                            highlight=item["highlight"],
                            type=item.get("type", "word"),
                            context=item["context"],
                            highlight_translation=item.get("highlight_translation", item.get("context_translation", "")),
                            cefr_level="C1",
                            importance_score=90,
                            dictionary_meanings=[],
                            why_interesting=item.get("why_interesting", ""),
                            pattern_template=""
                        )
                        all_highlights.append(highlight)
                print(f"‚úÖ v3_adaptive: —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ {len(all_highlights)} —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∏–∑ –ø–ª–æ—Å–∫–æ–≥–æ —Å–ø–∏—Å–∫–∞", flush=True)
                print(f"   ‚Ä¢ Highlights: {len([h for h in all_highlights if h.type != 'pattern'])}", flush=True)
                print(f"   ‚Ä¢ Patterns: {len([h for h in all_highlights if h.type == 'pattern'])}", flush=True)
                return all_highlights

            # –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º highlights
            for item in data.get("highlights", []):
                if not self._validate_highlight(item):
                    continue

                highlight = Highlight(
                    highlight=item["highlight"],
                    type=item.get("type", "word"),
                    context=item["context"],
                    highlight_translation=item.get("highlight_translation", item.get("context_translation", "")),
                    cefr_level="C1",
                    importance_score=90,
                    dictionary_meanings=[],
                    why_interesting=item.get("why_interesting", ""),
                    pattern_template=""  # –ü—É—Å—Ç–æ –¥–ª—è highlights
                )
                all_highlights.append(highlight)

            # –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º patterns
            for item in data.get("patterns", []):
                if not self._validate_pattern(item):
                    continue

                highlight = Highlight(
                    highlight=item["example"],  # –ü—Ä–∏–º–µ—Ä –∏–∑ —Ç–µ–∫—Å—Ç–∞
                    type="pattern",
                    context=item["context"],
                    highlight_translation="",  # Patterns –Ω–µ –ø–µ—Ä–µ–≤–æ–¥–∏–º
                    cefr_level="C1",
                    importance_score=95,
                    dictionary_meanings=[],  # Patterns –Ω–µ –∏–º–µ—é—Ç —Å–ª–æ–≤–∞—Ä–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
                    why_interesting=item.get("why_interesting", ""),
                    pattern_template=item.get("pattern_template", "")  # –®–∞–±–ª–æ–Ω!
                )
                all_highlights.append(highlight)

            print(f"‚úÖ v3_adaptive: —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ {len(all_highlights)} —ç–ª–µ–º–µ–Ω—Ç–æ–≤", flush=True)
            print(f"   ‚Ä¢ Highlights: {len([h for h in all_highlights if h.type != 'pattern'])}", flush=True)
            print(f"   ‚Ä¢ Patterns: {len([h for h in all_highlights if h.type == 'pattern'])}", flush=True)

            return all_highlights

        except Exception as e:
            print(f"‚ùå –û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ v3_adaptive –æ—Ç–≤–µ—Ç–∞: {e}", flush=True)
            print(f"‚ùå –û—Ç–≤–µ—Ç –±—ã–ª: {response[:300]}...", flush=True)
            import traceback
            traceback.print_exc()
            return []

    def _validate_highlight(self, item: dict) -> bool:
        """–í–∞–ª–∏–¥–∞—Ü–∏—è highlight —ç–ª–µ–º–µ–Ω—Ç–∞"""
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π
        required_fields = ["highlight", "context"]
        for field in required_fields:
            if field not in item or not item[field]:
                print(f"‚ö†Ô∏è v3: –ø—Ä–æ–ø—É—Å–∫–∞—é highlight - –Ω–µ—Ç –ø–æ–ª—è '{field}'", flush=True)
                return False

        # why_interesting –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ - –µ—Å–ª–∏ –Ω–µ—Ç, –¥–æ–±–∞–≤–∏–º –∑–∞–≥–ª—É—à–∫—É
        if "why_interesting" not in item or not item["why_interesting"]:
            item["why_interesting"] = "–ò–Ω—Ç–µ—Ä–µ—Å–Ω–æ–µ —Å–ª–æ–≤–æ"
            print(f"‚ö†Ô∏è v3: '{item['highlight']}' - –Ω–µ—Ç why_interesting, –¥–æ–±–∞–≤–ª—è—é –∑–∞–≥–ª—É—à–∫—É", flush=True)

        # –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ highlight –µ—Å—Ç—å –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ
        highlight_lower = item["highlight"].lower()
        context_lower = item["context"].lower()
        if highlight_lower not in context_lower:
            print(f"‚ö†Ô∏è v3: –ø—Ä–æ–ø—É—Å–∫–∞—é '{item['highlight']}' - –Ω–µ –Ω–∞–π–¥–µ–Ω–æ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ", flush=True)
            return False

        return True

    def _validate_pattern(self, item: dict) -> bool:
        """–í–∞–ª–∏–¥–∞—Ü–∏—è pattern —ç–ª–µ–º–µ–Ω—Ç–∞"""
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π
        required_fields = ["example", "pattern_template", "context"]
        for field in required_fields:
            if field not in item or not item[field]:
                print(f"‚ö†Ô∏è v3: –ø—Ä–æ–ø—É—Å–∫–∞—é pattern - –Ω–µ—Ç –ø–æ–ª—è '{field}'", flush=True)
                return False

        # why_interesting –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ - –µ—Å–ª–∏ –Ω–µ—Ç, –¥–æ–±–∞–≤–∏–º –∑–∞–≥–ª—É—à–∫—É
        if "why_interesting" not in item or not item["why_interesting"]:
            item["why_interesting"] = "–ò–Ω—Ç–µ—Ä–µ—Å–Ω–∞—è –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è"
            print(f"‚ö†Ô∏è v3: pattern '{item['example']}' - –Ω–µ—Ç why_interesting, –¥–æ–±–∞–≤–ª—è—é –∑–∞–≥–ª—É—à–∫—É", flush=True)

        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è placeholders –≤ template (–º—è–≥–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞)
        if '[' not in item["pattern_template"] or ']' not in item["pattern_template"]:
            print(f"‚ö†Ô∏è v3: –ø—Ä–æ–ø—É—Å–∫–∞—é pattern - –Ω–µ—Ç [placeholders] –≤ —à–∞–±–ª–æ–Ω–µ: {item['pattern_template']}", flush=True)
            return False

        # –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ example –µ—Å—Ç—å –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ
        example_lower = item["example"].lower()
        context_lower = item["context"].lower()
        if example_lower not in context_lower:
            print(f"‚ö†Ô∏è v3: –ø—Ä–æ–ø—É—Å–∫–∞—é pattern '{item['example']}' - –Ω–µ –Ω–∞–π–¥–µ–Ω–æ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ", flush=True)
            return False

        return True

    def _validate_why_interesting(self, why_text: str) -> bool:
        """
        –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —á—Ç–æ why_interesting —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–Ω–∫—Ä–µ—Ç–∏–∫—É, –∞ –Ω–µ —Ç–æ–ª—å–∫–æ generic —Ñ—Ä–∞–∑—ã
        """
        why_lower = why_text.lower()

        # –ï—Å–ª–∏ —Ç–µ–∫—Å—Ç –∫–æ—Ä–æ—Ç–∫–∏–π –∏ —Å–æ–¥–µ—Ä–∂–∏—Ç generic —Ñ—Ä–∞–∑—ã - –æ—Ç–∫–ª–æ–Ω—è–µ–º
        if len(why_text) < 80:
            for generic in GENERIC_PHRASES:
                if generic in why_lower:
                    return False

        return True

    async def _add_translations(self, highlights: List[Highlight], ai_client) -> List[Highlight]:
        """–î–æ–±–∞–≤–ª—è–µ—Ç –ø–µ—Ä–µ–≤–æ–¥—ã –∫ —Ö–∞–π–ª–∞–π—Ç–∞–º (–ù–ï –¥–ª—è patterns!) - legacy, –æ–±—ã—á–Ω–æ –ø–µ—Ä–µ–≤–æ–¥ —É–∂–µ –µ—Å—Ç—å –æ—Ç AI"""
        print(f"üîÑ –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–µ—Ä–µ–≤–æ–¥—ã —Ö–∞–π–ª–∞–π—Ç–æ–≤...", flush=True)
        for highlight in highlights:
            # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º patterns
            if highlight.type == "pattern":
                continue

            try:
                if not highlight.highlight_translation:
                    # –ü–µ—Ä–µ–≤–æ–¥–∏–º —Ç–æ–ª—å–∫–æ —Å–∞–º–æ —Å–ª–æ–≤–æ/—Ñ—Ä–∞–∑—É —á–µ—Ä–µ–∑ Translate API
                    print(f"üîÑ –ü–µ—Ä–µ–≤–æ–¥–∏–º '{highlight.highlight}'...", flush=True)
                    translation = await ai_client.translate_text(highlight.highlight, "ru")
                    highlight.highlight_translation = translation
                    print(f"‚úÖ –ü–µ—Ä–µ–≤–æ–¥ '{highlight.highlight}' -> '{translation}'", flush=True)
                else:
                    print(f"‚è≠Ô∏è  –ü—Ä–æ–ø—É—Å–∫–∞–µ–º '{highlight.highlight}' - –ø–µ—Ä–µ–≤–æ–¥ —É–∂–µ –µ—Å—Ç—å", flush=True)
            except Exception as e:
                print(f"‚ö†Ô∏è –û—à–∏–±–∫–∞ –ø–µ—Ä–µ–≤–æ–¥–∞ '{highlight.highlight}': {e}", flush=True)

        print(f"‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–≤–æ–¥–æ–≤ –∑–∞–≤–µ—Ä—à–µ–Ω–∞", flush=True)
        return highlights

    async def _add_dictionary_meanings(self, highlights: List[Highlight], ai_client) -> List[Highlight]:
        """–î–æ–±–∞–≤–ª—è–µ—Ç —Å–ª–æ–≤–∞—Ä–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —Ç–æ–ª—å–∫–æ –¥–ª—è highlights (–Ω–µ –¥–ª—è patterns)"""
        print(f"üìö –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ª–æ–≤–∞—Ä–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è highlights...", flush=True)

        for highlight in highlights:
            # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º patterns
            if highlight.type == "pattern":
                continue

            # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —Ñ—Ä–∞–∑—ã (—Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω–æ—á–Ω—ã–µ —Å–ª–æ–≤–∞)
            if ' ' in highlight.highlight.strip():
                continue

            try:
                meanings = ai_client.get_dictionary_meanings(highlight.highlight)

                # –§–∏–ª—å—Ç—Ä—É–µ–º - —É–±–∏—Ä–∞–µ–º –æ—Å–Ω–æ–≤–Ω–æ–π –ø–µ—Ä–µ–≤–æ–¥
                main_translation = highlight.highlight_translation.lower().strip()
                filtered_meanings = [
                    m for m in meanings
                    if m.lower().strip() != main_translation
                ]

                highlight.dictionary_meanings = filtered_meanings

            except Exception as e:
                print(f"‚ö†Ô∏è –û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è '{highlight.highlight}': {e}", flush=True)

        return highlights
